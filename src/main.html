<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Team Member Randomizer</title>
    <link rel="stylesheet" type="text/css" href="styles/main.css" />
  </head>
  <body>
    <div id="default">Users will never see this page.</div>
    <script src="scripts/utils.js"></script>
    <script type="module">
      'use strict';
      import * as SDK from '../node_modules/azure-devops-extension-sdk/esm/SDK.js';

      SDK.init({ applyTheme: true });

      SDK.register('teamMemberRandomizerButton', () => {
        return {
          execute: async (properties) => {
            const dialogService = await SDK.getService('ms.vss-web.dialog-service');
            const extensionInfo = SDK.getExtensionContext();

            const options = {
              title: 'Team Members',
              width: 400,
              height: 650,
              buttons: {
                'Next': {
                  text: 'Next',
                  click: function() {
                    const dialog = this;
                    dialog.getContributionInstance('popupDialog').then((instance) => {
                      if (instance && instance.onNext) {
                        instance.onNext();
                      }
                    });
                  }
                },
                'Start Over': {
                  text: 'Start Over',
                  click: function() {
                    const dialog = this;
                    dialog.getContributionInstance('popupDialog').then((instance) => {
                      if (instance && instance.onStartOver) {
                        instance.onStartOver();
                      }
                    });
                  }
                },
                'Close': {
                  text: 'Close',
                  click: function() {
                    this.close();
                  }
                }
              }
            };
            initStorage();
            dialogService.openDialog(extensionInfo.publisherId + '.' + extensionInfo.extensionId + '.popupDialog', options, {
              properties
            });
          }
        };
      });
    </script>
  </body>
</html>
